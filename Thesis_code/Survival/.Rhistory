library(flextable)
library(grid)
library(gridExtra)
library(cowplot)
library(stargazer)
library(scales)
library(pROC)
library(patchwork)
library(survminer)
library(ggsci)
library(survival)
library(foreign)
library(kableExtra)
library(ggplot2)
library(broom)
library(GGally)
library(tidyr)
library(knitr)
library(xtable)
students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_Students.tab", header = T, sep = "\t", fill = TRUE)
schools <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_K-3_Schools.tab", header = T, sep = "\t", fill = TRUE)
comparison_students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/Comparison_Students.tab", header = T, sep = "\t", fill = TRUE)
# Converting test scores to numeric types
students$g1tmathss <- as.numeric(students$g1tmathss)
students$g1treadss <- as.numeric(students$g1treadss)
students$g1tlistss <- as.numeric(students$g1tlistss)
students$g1wordskillss <- as.numeric(students$g1wordskillss)
students$gktmathss <- as.numeric(students$gktmathss)
students$gktreadss <- as.numeric(students$gktreadss)
students$gktlistss <- as.numeric(students$gktlistss)
students$gkwordskillss <- as.numeric(students$gkwordskillss)
students$g2tmathss <- as.numeric(students$g2tmathss)
students$g3tmathss <- as.numeric(students$g3tmathss)
students <- students %>%
rename(flagsgk = var6, flagsg1 = var7, flagsg2 = var8, flagsg3 = var9)
students_survival <- students %>%
filter(yearsstar != 0, gkschid != 128068 | gkschid != 180344 | gkschid != 205489 | gkschid != 216536 | gkschid != 244818)
survival_k_entry <- students %>%
filter(flagsgk == 1) %>%
mutate(did_leave = case_when(yearsstar == 4 ~ 0, yearsstar != 4 ~ 1), when_first_leave = case_when(flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 1 ~ 0,flagsg1 == 0 ~ 1, flagsg2 == 0 & flagsg1 == 1 ~ 2, flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 0 ~ 3)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 4, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2, when_first_leave == 3 ~ 3))
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkfreelunch, data = survival_k_entry)
income_plot <- ggsurvplot(fit_ct, data = survival_k_entry, pval = TRUE, title = "Survival Probabilities by Free Lunch Status in Kindergarten", subtitle = "Among Kindergarten Entry Cohort", risk.table = TRUE,
tables.height = 0.2, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(),
xlab = "Years in Project STAR", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Free Lunch", "Non-Free Lunch"), palette = "nejm", ggtheme = theme_pubr())
ggsave("Survival_Income.pdf", plot = ggarrange(income_plot$plot, income_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
survival_k_entry <- survival_k_entry %>%
mutate(total_math_reading_k = gktmathss + gktreadss + gktlistss + gkwordskillss) %>%
mutate(gk_ability_quartile = ntile(total_math_reading_k, 100)) %>%
mutate(gk_ability_category = case_when(gk_ability_quartile <= 25 ~ 1, gk_ability_quartile > 25 & gk_ability_quartile < 75 ~ 2, gk_ability_quartile >= 75 ~ 3))
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gk_ability_category, data = survival_k_entry)
ability_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Test Scores", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("25th Percentile or Below", "Between 25th-75th Percentiles", "75th+ Percentile"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_Ability.pdf", plot = ggarrange(ability_plot$plot, ability_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkclasstype, data = survival_k_entry)
classtype_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Class Type", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Small", "Regular", "Aide"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_ClassType.pdf", plot = ggarrange(classtype_plot$plot, classtype_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gksurban, data = survival_k_entry)
schoolurb_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten School Urbanicity", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Inner City", "Suburban", "Rural", "Urban"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_SchoolType.pdf", plot = ggarrange(schoolurb_plot$plot, schoolurb_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
test <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid==g3schid)) %>%
select(gkschid, g3schid, when_first_leave, switched_schools)
View(test)
test <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid)) %>%
select(gkschid, g3schid, when_first_leave, switched_schools)
test1 <- survival_k_entry %>%
filter(gkschid!=g1schid & gkschid==g2schid)
View(test1)
test1 <- survival_k_entry %>%
filter(gkschid!=g1schid & gkschid==g3schid)
colnames(survival_k_entry)
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype)) %>%
select(gkschid, g3schid, when_first_leave, switched_schools)
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ gkfreelunch + gksurban + switched_schools + gkclasstype + switched_classes + gk_ability_category + gender + race + gktgen + gktyears + gkspeced + gkspecin + gkabsent,
data=data, survival_k_entry = "weibull")
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype)) %>%
select(gkschid, g3schid, when_first_leave, switched_schools)
library(tidyverse)
library(dplyr)
library(flextable)
library(grid)
library(gridExtra)
library(cowplot)
library(stargazer)
library(scales)
library(pROC)
library(patchwork)
library(survminer)
library(ggsci)
library(survival)
library(foreign)
library(kableExtra)
library(ggplot2)
library(broom)
library(GGally)
library(tidyr)
library(knitr)
library(xtable)
students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_Students.tab", header = T, sep = "\t", fill = TRUE)
schools <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_K-3_Schools.tab", header = T, sep = "\t", fill = TRUE)
comparison_students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/Comparison_Students.tab", header = T, sep = "\t", fill = TRUE)
# Converting test scores to numeric types
students$g1tmathss <- as.numeric(students$g1tmathss)
students$g1treadss <- as.numeric(students$g1treadss)
students$g1tlistss <- as.numeric(students$g1tlistss)
students$g1wordskillss <- as.numeric(students$g1wordskillss)
students$gktmathss <- as.numeric(students$gktmathss)
students$gktreadss <- as.numeric(students$gktreadss)
students$gktlistss <- as.numeric(students$gktlistss)
students$gkwordskillss <- as.numeric(students$gkwordskillss)
students$g2tmathss <- as.numeric(students$g2tmathss)
students$g3tmathss <- as.numeric(students$g3tmathss)
students <- students %>%
rename(flagsgk = var6, flagsg1 = var7, flagsg2 = var8, flagsg3 = var9)
students_survival <- students %>%
filter(yearsstar != 0, gkschid != 128068 | gkschid != 180344 | gkschid != 205489 | gkschid != 216536 | gkschid != 244818)
survival_k_entry <- students %>%
filter(flagsgk == 1) %>%
mutate(did_leave = case_when(yearsstar == 4 ~ 0, yearsstar != 4 ~ 1), when_first_leave = case_when(flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 1 ~ 0,flagsg1 == 0 ~ 1, flagsg2 == 0 & flagsg1 == 1 ~ 2, flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 0 ~ 3)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 4, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2, when_first_leave == 3 ~ 3))
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkfreelunch, data = survival_k_entry)
income_plot <- ggsurvplot(fit_ct, data = survival_k_entry, pval = TRUE, title = "Survival Probabilities by Free Lunch Status in Kindergarten", subtitle = "Among Kindergarten Entry Cohort", risk.table = TRUE,
tables.height = 0.2, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(),
xlab = "Years in Project STAR", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Free Lunch", "Non-Free Lunch"), palette = "nejm", ggtheme = theme_pubr())
ggsave("Survival_Income.pdf", plot = ggarrange(income_plot$plot, income_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
survival_k_entry <- survival_k_entry %>%
mutate(total_math_reading_k = gktmathss + gktreadss + gktlistss + gkwordskillss) %>%
mutate(gk_ability_quartile = ntile(total_math_reading_k, 100)) %>%
mutate(gk_ability_category = case_when(gk_ability_quartile <= 25 ~ 1, gk_ability_quartile > 25 & gk_ability_quartile < 75 ~ 2, gk_ability_quartile >= 75 ~ 3))
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gk_ability_category, data = survival_k_entry)
ability_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Test Scores", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("25th Percentile or Below", "Between 25th-75th Percentiles", "75th+ Percentile"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_Ability.pdf", plot = ggarrange(ability_plot$plot, ability_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkclasstype, data = survival_k_entry)
classtype_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Class Type", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Small", "Regular", "Aide"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_ClassType.pdf", plot = ggarrange(classtype_plot$plot, classtype_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gksurban, data = survival_k_entry)
schoolurb_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten School Urbanicity", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Inner City", "Suburban", "Rural", "Urban"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_SchoolType.pdf", plot = ggarrange(schoolurb_plot$plot, schoolurb_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype)) %>%
select(gkschid, g3schid, when_first_leave, switched_schools)
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ gkfreelunch + gksurban + switched_schools + gkclasstype + switched_classes + gk_ability_category + gender + race + gktgen + gktyears + gkspeced + gkspecin + gkabsent,
data=survival_k_entry, dist = "weibull")
library(tidyverse)
library(dplyr)
library(flextable)
library(grid)
library(gridExtra)
library(cowplot)
library(stargazer)
library(scales)
library(pROC)
library(patchwork)
library(survminer)
library(ggsci)
library(survival)
library(foreign)
library(kableExtra)
library(ggplot2)
library(broom)
library(GGally)
library(tidyr)
library(knitr)
library(xtable)
students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_Students.tab", header = T, sep = "\t", fill = TRUE)
schools <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_K-3_Schools.tab", header = T, sep = "\t", fill = TRUE)
comparison_students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/Comparison_Students.tab", header = T, sep = "\t", fill = TRUE)
# Converting test scores to numeric types
students$g1tmathss <- as.numeric(students$g1tmathss)
students$g1treadss <- as.numeric(students$g1treadss)
students$g1tlistss <- as.numeric(students$g1tlistss)
students$g1wordskillss <- as.numeric(students$g1wordskillss)
students$gktmathss <- as.numeric(students$gktmathss)
students$gktreadss <- as.numeric(students$gktreadss)
students$gktlistss <- as.numeric(students$gktlistss)
students$gkwordskillss <- as.numeric(students$gkwordskillss)
students$g2tmathss <- as.numeric(students$g2tmathss)
students$g3tmathss <- as.numeric(students$g3tmathss)
students <- students %>%
rename(flagsgk = var6, flagsg1 = var7, flagsg2 = var8, flagsg3 = var9)
students_survival <- students %>%
filter(yearsstar != 0, gkschid != 128068 | gkschid != 180344 | gkschid != 205489 | gkschid != 216536 | gkschid != 244818)
survival_k_entry <- students %>%
filter(flagsgk == 1) %>%
mutate(did_leave = case_when(yearsstar == 4 ~ 0, yearsstar != 4 ~ 1), when_first_leave = case_when(flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 1 ~ 0,flagsg1 == 0 ~ 1, flagsg2 == 0 & flagsg1 == 1 ~ 2, flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 0 ~ 3)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 4, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2, when_first_leave == 3 ~ 3))
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkfreelunch, data = survival_k_entry)
income_plot <- ggsurvplot(fit_ct, data = survival_k_entry, pval = TRUE, title = "Survival Probabilities by Free Lunch Status in Kindergarten", subtitle = "Among Kindergarten Entry Cohort", risk.table = TRUE,
tables.height = 0.2, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(),
xlab = "Years in Project STAR", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Free Lunch", "Non-Free Lunch"), palette = "nejm", ggtheme = theme_pubr())
ggsave("Survival_Income.pdf", plot = ggarrange(income_plot$plot, income_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
survival_k_entry <- survival_k_entry %>%
mutate(total_math_reading_k = gktmathss + gktreadss + gktlistss + gkwordskillss) %>%
mutate(gk_ability_quartile = ntile(total_math_reading_k, 100)) %>%
mutate(gk_ability_category = case_when(gk_ability_quartile <= 25 ~ 1, gk_ability_quartile > 25 & gk_ability_quartile < 75 ~ 2, gk_ability_quartile >= 75 ~ 3))
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gk_ability_category, data = survival_k_entry)
ability_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Test Scores", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("25th Percentile or Below", "Between 25th-75th Percentiles", "75th+ Percentile"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_Ability.pdf", plot = ggarrange(ability_plot$plot, ability_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkclasstype, data = survival_k_entry)
library(tidyverse)
library(dplyr)
library(flextable)
library(grid)
library(gridExtra)
library(cowplot)
library(stargazer)
library(scales)
library(pROC)
library(patchwork)
library(survminer)
library(ggsci)
library(survival)
library(foreign)
library(kableExtra)
library(ggplot2)
library(broom)
library(GGally)
library(tidyr)
library(knitr)
library(xtable)
students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_Students.tab", header = T, sep = "\t", fill = TRUE)
schools <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/STAR_K-3_Schools.tab", header = T, sep = "\t", fill = TRUE)
comparison_students <- read.table("/Users/Sanscubed/Desktop/Thesis/Thesis_data/STAR_Archive/Comparison_Students.tab", header = T, sep = "\t", fill = TRUE)
# Converting test scores to numeric types
students$g1tmathss <- as.numeric(students$g1tmathss)
students$g1treadss <- as.numeric(students$g1treadss)
students$g1tlistss <- as.numeric(students$g1tlistss)
students$g1wordskillss <- as.numeric(students$g1wordskillss)
students$gktmathss <- as.numeric(students$gktmathss)
students$gktreadss <- as.numeric(students$gktreadss)
students$gktlistss <- as.numeric(students$gktlistss)
students$gkwordskillss <- as.numeric(students$gkwordskillss)
students$g2tmathss <- as.numeric(students$g2tmathss)
students$g3tmathss <- as.numeric(students$g3tmathss)
students <- students %>%
rename(flagsgk = var6, flagsg1 = var7, flagsg2 = var8, flagsg3 = var9)
students_survival <- students %>%
filter(yearsstar != 0, gkschid != 128068 | gkschid != 180344 | gkschid != 205489 | gkschid != 216536 | gkschid != 244818)
survival_k_entry <- students %>%
filter(flagsgk == 1) %>%
mutate(did_leave = case_when(yearsstar == 4 ~ 0, yearsstar != 4 ~ 1), when_first_leave = case_when(flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 1 ~ 0,flagsg1 == 0 ~ 1, flagsg2 == 0 & flagsg1 == 1 ~ 2, flagsg1 == 1 & flagsg2 == 1 & flagsg3 == 0 ~ 3)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 4, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2, when_first_leave == 3 ~ 3))
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkfreelunch, data = survival_k_entry)
income_plot <- ggsurvplot(fit_ct, data = survival_k_entry, pval = TRUE, title = "Survival Probabilities by Free Lunch Status in Kindergarten", subtitle = "Among Kindergarten Entry Cohort", risk.table = TRUE,
tables.height = 0.2, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(),
xlab = "Years in Project STAR", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Free Lunch", "Non-Free Lunch"), palette = "nejm", ggtheme = theme_pubr())
ggsave("Survival_Income.pdf", plot = ggarrange(income_plot$plot, income_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
survival_k_entry <- survival_k_entry %>%
mutate(total_math_reading_k = gktmathss + gktreadss + gktlistss + gkwordskillss) %>%
mutate(gk_ability_quartile = ntile(total_math_reading_k, 100)) %>%
mutate(gk_ability_category = case_when(gk_ability_quartile <= 25 ~ 1, gk_ability_quartile > 25 & gk_ability_quartile < 75 ~ 2, gk_ability_quartile >= 75 ~ 3))
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gk_ability_category, data = survival_k_entry)
ability_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Test Scores", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("25th Percentile or Below", "Between 25th-75th Percentiles", "75th+ Percentile"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_Ability.pdf", plot = ggarrange(ability_plot$plot, ability_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
# Using Mine
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gkclasstype, data = survival_k_entry)
classtype_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten Class Type", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Small", "Regular", "Aide"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_ClassType.pdf", plot = ggarrange(classtype_plot$plot, classtype_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
fit_ct <- survfit(Surv(years_until_first_leave, did_leave) ~ gksurban, data = survival_k_entry)
schoolurb_plot <- ggsurvplot(fit_ct, data = survival_k_entry, title = "Survival Probabilities by Kindergarten School Urbanicity", subtitle = "Among Kindergarten Entry Cohort",
xlab = "Years in Expiriment", ylab = "Estimated Survival Probability",
conf.int = T, censor = T,legend.labs = c("Inner City", "Suburban", "Rural", "Urban"), risk.table = TRUE,
tables.height = 0.5, risk.table.title = "Number at risk:",
tables.theme = theme_cleantable(), palette = "nejm", ggtheme = theme_pubr(), pval = TRUE)
ggsave("Survival_SchoolType.pdf", plot = ggarrange(schoolurb_plot$plot, schoolurb_plot$table, nrow=2, ncol=1, heights=c(3,1)), path = "/Users/Sanscubed/Desktop/Thesis/Thesis_figures/")
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype))
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ gkfreelunch + gksurban + switched_schools + gkclasstype + switched_classes + gk_ability_category + gender + race + gktgen + gktyears + gkspeced + gkspecin + gkabsent,
data=survival_k_entry, dist = "weibull")
summary(survival_k_entry$gktgen)
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype))
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ gkfreelunch + gksurban + switched_schools + gkclasstype + switched_classes + gk_ability_category + gender + race + gktyears + gkspeced + gkspecin + gkabsent,
data=survival_k_entry, dist = "weibull")
#Model summary
summary(weibull_k_entry)
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype))
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(gkfreelunch) + as.factor(gksurban) + as.factor(switched_schools) + as.factor(gkclasstype) + as.factor(switched_classes) + as.factor(gk_ability_category) + as.factor(gender) + as.factor(race) + gktyears + as.factor(gkspeced) + as.factor(gkspecin) + gkabsent,
data=survival_k_entry, dist = "weibull")
#Model summary
summary(weibull_k_entry)
survival_1_entry <- students %>%
filter(flagsgk == 0 && flagsg1 == 1) %>%
mutate(did_leave = case_when(yearsstar == 3 ~ 0, yearsstar != 3 ~ 1), when_first_leave = case_when(flagsg2 == 1 & flagsg3 == 1 ~ 0, flagsg2 == 0 ~ 1, flagsg2 == 1 & flagsg3 == 0 ~ 2)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 3, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2)) %>%
mutate(total_math_reading_1 = g1tmathss + g1treadss + g1tlistss + g1wordskillss) %>%
mutate(g1_ability_quartile = ntile(total_math_reading_1, 100)) %>%
mutate(g1_ability_category = case_when(g1_ability_quartile <= 25 ~ 1, g1_ability_quartile > 25 & g1_ability_quartile < 75 ~ 2, g1_ability_quartile >= 75 ~ 3)) %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ g1schid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ g1schid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ g1classtype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ g1classtype!=g2classtype))
# Model for 1st grade entry cohort
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "weibull")
#Model summary
summary(weibull_k_entry)
survival_1_entry <- students %>%
filter(flagsgk == 0 && flagsg1 == 1) %>%
mutate(did_leave = case_when(yearsstar == 3 ~ 0, yearsstar != 3 ~ 1), when_first_leave = case_when(flagsg2 == 1 & flagsg3 == 1 ~ 0, flagsg2 == 0 ~ 1, flagsg2 == 1 & flagsg3 == 0 ~ 2)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 3, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2)) %>%
mutate(total_math_reading_1 = g1tmathss + g1treadss + g1tlistss + g1wordskillss) %>%
mutate(g1_ability_quartile = ntile(total_math_reading_1, 100)) %>%
mutate(g1_ability_category = case_when(g1_ability_quartile <= 25 ~ 1, g1_ability_quartile > 25 & g1_ability_quartile < 75 ~ 2, g1_ability_quartile >= 75 ~ 3)) %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ g1schid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ g1schid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ g1classtype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ g1classtype!=g2classtype))
# Model for 1st grade entry cohort
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "weibull")
#Model summary
summary(weibull_1_entry)
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "exponential")
#Model summary
summary(weibull_1_entry)
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "weibull")
#Model summary
summary(weibull_1_entry)
resids <- (log(survival_1_entry$years_until_first_leave) - weibull_1_entry$linear.predictors) / (weibull_1_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_1_entry)
plot(rmod, xlab = "AFT Residuals (Logistic model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "exponential")
#Model summary
summary(weibull_1_entry)
resids <- (log(survival_1_entry$years_until_first_leave) - weibull_1_entry$linear.predictors) / (weibull_1_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_1_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "loglogistic")
#Model summary
summary(weibull_1_entry)
resids <- (log(survival_1_entry$years_until_first_leave) - weibull_1_entry$linear.predictors) / (weibull_1_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_1_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
# Model for 1st grade entry cohort
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "weibull")
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
survival_1_entry <- students %>%
filter(flagsgk == 0 && flagsg1 == 1) %>%
mutate(did_leave = case_when(yearsstar == 3 ~ 0, yearsstar != 3 ~ 1), when_first_leave = case_when(flagsg2 == 1 & flagsg3 == 1 ~ 0, flagsg2 == 0 ~ 1, flagsg2 == 1 & flagsg3 == 0 ~ 2)) %>%
mutate(years_until_first_leave = case_when(when_first_leave == 0 ~ 3, when_first_leave == 1 ~ 1, when_first_leave == 2 ~ 2)) %>%
mutate(total_math_reading_1 = g1tmathss + g1treadss + g1tlistss + g1wordskillss) %>%
mutate(g1_ability_quartile = ntile(total_math_reading_1, 100)) %>%
mutate(g1_ability_category = case_when(g1_ability_quartile <= 25 ~ 1, g1_ability_quartile > 25 & g1_ability_quartile < 75 ~ 2, g1_ability_quartile >= 75 ~ 3)) %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ g1schid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ g1schid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ g1classtype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ g1classtype!=g2classtype))
# Model for 1st grade entry cohort
weibull_1_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(g1freelunch) + as.factor(g1surban) + as.factor(switched_schools) + as.factor(g1classtype) + as.factor(switched_classes) + as.factor(g1_ability_category) + as.factor(gender) + as.factor(race) + g1tgen + g1tyears + as.factor(g1speced) + as.factor(g1specin) + g1absent,
data=survival_1_entry, dist = "weibull")
#Model summary
summary(weibull_1_entry)
resids <- (log(survival_1_entry$years_until_first_leave) - weibull_1_entry$linear.predictors) / (weibull_1_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_1_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
lines(exp.x, col = "red", lwd = 2)
resids <- (log(survival_1_entry$years_until_first_leave) - weibull_1_entry$linear.predictors) / (weibull_1_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_1_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, col = "red", lwd = 2)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
resids <- (log(survival_1_entry$years_until_first_leave) - weibull_1_entry$linear.predictors) / (weibull_1_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_1_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
resids <- (log(survival_k_entry$years_until_first_leave) - weibull_k_entry$linear.predictors) / (weibull_k_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_k_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
#Model summary
summary(weibull_k_entry)
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype))
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(gkfreelunch) + as.factor(gksurban) + as.factor(switched_schools) + as.factor(gkclasstype) + as.factor(switched_classes) + as.factor(gk_ability_category) + as.factor(gender) + as.factor(race) + gktyears + as.factor(gkspeced) + as.factor(gkspecin) + gkabsent,
data=survival_k_entry, dist = "exponential")
#Model summary
summary(weibull_k_entry)
resids <- (log(survival_k_entry$years_until_first_leave) - weibull_k_entry$linear.predictors) / (weibull_k_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_k_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
# -	Vars of interest:
# switched classes (disaggregate into stayed same, switched from regular to small, switched from small to larger),
#
# -	Controls:
# kindergarten school grade range, exit school grade range, if the school left the experiment, percent students receiving free/reduced lunch in K, percent students bused in K
survival_k_entry <- survival_k_entry %>%
mutate(switched_schools = case_when(when_first_leave == 0 ~ gkschid!=g3schid, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkschid!=g1schid, when_first_leave == 3 ~ gkschid!=g2schid), switched_classes = case_when(when_first_leave == 0 ~ gkclasstype!=g3classtype, when_first_leave == 1 ~ FALSE, when_first_leave == 2 ~ gkclasstype!=g1classtype, when_first_leave == 3 ~ gkclasstype!=g1classtype))
# Model of attrition between k to 1st grade, note teacher gender not controlled for as there are only female teachers in gk
weibull_k_entry <- survreg(Surv(years_until_first_leave, did_leave)  ~ as.factor(gkfreelunch) + as.factor(gksurban) + as.factor(switched_schools) + as.factor(gkclasstype) + as.factor(switched_classes) + as.factor(gk_ability_category) + as.factor(gender) + as.factor(race) + gktyears + as.factor(gkspeced) + as.factor(gkspecin) + gkabsent,
data=survival_k_entry, dist = "weibull")
#Model summary
summary(weibull_k_entry)
resids <- (log(survival_k_entry$years_until_first_leave) - weibull_k_entry$linear.predictors) / (weibull_k_entry$scale)
rmod <- survfit(Surv(resids, did_leave) ~ 1, data = survival_k_entry)
plot(rmod, xlab = "AFT Residuals (Weibull model)", ylab = "Survival Probability")
exp.x <- seq(min(resids), max(resids), length = 100)
exp.y <- plogis(exp.x, lower.tail = F) # F(t)
lines(exp.x, exp.y, col = "red", lwd = 2)
